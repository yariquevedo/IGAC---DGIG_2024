#SEMILLERO DE INVESTIGACIÓN Y DESARROLLO 
#FECHA DE REALIZACIÓN: 21/04/2024
#DESCRIPCIÓN: SCRIPT QUE PERMITE DIVIDIR LAS VEREDAS EN COMÚN ENTRE DOS MUNICIPIOS Y AGREGAR A CADA POLÍGOO EL NOMBRE
#YARITZA QUEVEDO
#----------------------------------------------------------------------------
import arcpy, os


#municipios = r"\\172.26.0.20\Elite_Sub_Geografia_Cartografia\Coberturas\GDB_FLET_Agosto_2023.gdb\Limites_Entidades_Territoriales\Munpio"

ruta_salida = arcpy.GetParameterAsText(0)
municipios = arcpy.GetParameterAsText(1)
veredas = arcpy.GetParameterAsText(2)

#Sobrescribir datos de salida
arcpy.env.overwriteOutput = True

# Crear geodatabase temporal
GDB_temp_result = arcpy.management.CreateFileGDB(ruta_salida, "GDB_temp.gdb")
GDB_temp = GDB_temp_result.getOutput(0)  # Obtener el nombre completo de la geodatabase temporal

def division(municipios, veredas):
    #Cambiar la geometría de los municipios de tipo poligono a línea
    lineas = arcpy.management.PolygonToLine(municipios, os.path.join(GDB_temp, "lineas_municipio"), "IGNORE_NEIGHBORS")
    intersect = arcpy.analysis.Intersect(veredas, lineas, "ALL","","INPUT")
    arcpy.AddMessage ("Dividiendo veredas")
    copy = arcpy.management.Copy(intersect, os.path.join(GDB_temp, "veredas_divididas"))
    #clip = arcpy.analysis.Clip(municipios, veredas, os.path.join(ruta_salida, "veredas_divididas"))
    return copy
    
division(municipios, veredas)

# area_munpi = 0
# with arcpy.da.SearchCursor(temp, ["SHAPE@AREA"]) as cursor:
#     for row in cursor:
#             area_munpi = row[0] + area_munpi